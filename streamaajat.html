<!DOCTYPE html>
<html lang="fi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Suomalaiset Twitch-striimaajat</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            dark: '#1a1a1a',
            accent: '#4ade80',
          },
          animation: {
            fade: 'fadeIn 0.5s ease-in-out',
          },
          keyframes: {
            fadeIn: {
              '0%': { opacity: 0 },
              '100%': { opacity: 1 },
            },
          },
        },
      },
    };
  </script>
</head>
<body class="bg-dark text-white font-sans">
  <div class="max-w-4xl mx-auto p-6">
    <h1 class="text-3xl font-bold mb-6 text-center text-accent">ðŸ‡«ðŸ‡® Suomalaiset Twitch-striimaajat</h1>

    <input
      type="text"
      id="search"
      placeholder="Etsi striimaajaa..."
      class="w-full p-3 mb-6 rounded-lg bg-gray-800 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-accent"
    />

    <div id="streamer-list" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>

    <script>
      const streamers = [
        { name: 'J1mPPaZ', twitchId: 'j1mppaz' },
        { name: 'Skotti', twitchId: 'skotti' },
        { name: 'Gargee', twitchId: 'gargee' },
        { name: 'Lewaaw', twitchId: 'lewaaw' },
        { name: 'Novicci', twitchId: 'novicci' },
        { name: 'Laeppavika', twitchId: 'laeppavika' },
        { name: 'Hukkaw', twitchId: 'hukkaw' },
      ];

      async function fetchStreamData(username) {
        const res = await fetch(`https://decapi.me/twitch/status/${username}`);
        const text = await res.text();
        const isLive = !text.includes('offline');
        const viewersMatch = text.match(/\((\d+)\s+katsojaa/);
        const viewers = viewersMatch ? viewersMatch[1] : null;
        return { isLive, viewers, statusText: text };
      }

      window.onload = async () => {
        const list = document.getElementById('streamer-list');

        for (const s of streamers) {
          const card = document.createElement('div');
          card.className =
            'bg-gray-800 p-4 rounded-2xl shadow-lg animate-fade flex flex-col items-center text-center transition transform hover:scale-105 duration-300';
          card.setAttribute('data-name', s.name.toLowerCase());

          const twitchURL = `https://www.twitch.tv/${s.twitchId}`;
          const { isLive, viewers, statusText } = await fetchStreamData(s.twitchId);

          card.innerHTML = `
            <h2 class="text-xl font-semibold text-accent mb-2">${s.name}</h2>
            <p class="mb-2 text-sm italic">${statusText}</p>
            ${
              isLive
                ? `<span class="bg-red-500 text-white text-sm px-2 py-1 rounded mb-2">LIVE â€“ ${
                    viewers || '?'
                  } katsojaa</span>`
                : `<span class="text-gray-400 text-sm mb-2">Offline</span>`
            }
            <a href="${twitchURL}" target="_blank" class="bg-accent text-dark px-4 py-2 rounded-lg font-medium hover:bg-green-400 transition">Katso TwitchissÃ¤</a>
          `;
          list.appendChild(card);
        }

        const searchInput = document.getElementById('search');
        const streamerCards = list.children;

        searchInput.addEventListener('input', (e) => {
          const value = e.target.value.toLowerCase();
          for (let card of streamerCards) {
            const name = card.dataset.name;
            card.style.display = name.includes(value) ? '' : 'none';
          }
        });
      };
    </script>
  </div>
</body>
</html>
